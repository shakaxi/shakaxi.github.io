<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2019-04-14 Sun 23:04 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>NR - PTRS</title>
<meta name="generator" content="Org mode">
<meta name="author" content="shaka">
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="default.css"/>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2019 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">NR - PTRS</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec:intro">Introduction</a></li>
<li><a href="#sec:phase-noise-models">Phase Noise and Models</a></li>
<li><a href="#sec:presence-density"><span class="todo TODO">TODO</span> Presence and Density</a></li>
<li><a href="#sec:port-association">Port Association</a>
<ul>
<li><a href="#downlink">Downlink</a>
<ul>
<li><a href="#one-ptrs-port">One PTRS port</a></li>
<li><a href="#two-ptrs-ports">Two PTRS ports</a></li>
</ul>
</li>
<li><a href="#uplink"><span class="todo TODO">TODO</span> Uplink</a></li>
</ul>
</li>
<li><a href="#sec:sequ-gener-reso"><span class="todo TODO">TODO</span> Sequence Generation and Resource Mapping</a></li>
<li><a href="#sec:pn-estim-compl">Phase Noise Estimation and Complementation</a>
<ul>
<li><a href="#cp-ofdm">CP-OFDM</a></li>
<li><a href="#dft-s-ofdm">DFT-S-OFDM</a></li>
</ul>
</li>
<li><a href="#sec:summary"><span class="todo TODO">TODO</span> Summary</a></li>
</ul>
</div>
</div>

<div id="outline-container-org7406117" class="outline-2">
<h2 id="sec:intro">Introduction</h2>
<div class="outline-text-2" id="text-sec:intro">
<p>
Targetting for the great goal of the 5th generation (5G) system, the <i>new radio (NR)</i> system, proposed by the 3rd generation partner project (3GPP), has employed a variety of cutting-edge technologies, including advanced channel coding schemes, e.g., low density parity code (LDPC) and polar code, higher-order modulation schemes, e.g., 256QAM, etc. Considering the fact that the lower frequency spectrum has already been so crowded and overutilized, NR decided to explore higher frequency band, e.g., million meter wave (mmWave). After all, much richer spectrum resources are available at higher frequency bands than lower frequency spectrum.
</p>

<p>
As is well-known, high frequency transmission suffers severe attenuation loss in the propagation, which remarkably limits the effective coverage and transmission distance. Fortunately, higher frequency spectrum has shorter wave length. Given an aperture size, much more antennas can be equipped in higher frequency transmission than those in lower frequency transmission. In this way, more antennas can yield larger beamforming gain and complement the attenuation loss in the transmission over the higher frequency bands. In a word, higher frequency enables the dense deployment of antennas, i.e., <i>massive multi-input multi-output (M-MIMO)</i>, or equivalently <i>large-scale MIMO (LS-MIMO)</i>; while M-MIMO extends the transmission distance and coverage of the higher frequency bands. Therefore, M-MIMO and higher frequency transmission are usually jointly utilized and have been the focus of the research and discussion in the 3GPP standardization.
</p>

<p>
Generally, an oscillator always produces phase noise, which is essentially an impairment of the oscillator. Nevertheless, the phase noise soars as the operation frequency grows. In the NR system, which operates on higher frequency spectrum, the impact of phase noise cannot be ignored. Instead, the phase noise must be accurately estimated and complemented before data detection. To this end, a dedicated reference signal, termed <i>phase tracking reference signal (PTRS)</i> has been proposed to track the fluctuation of the phase noise.
</p>

<p>
This report intends to cover everything detail relating to PTRS. The remaining of this report is structured as follows. Section <a href="#sec:phase-noise-models">Phase Noise and Models</a> briefly introduces the models of phase noise, and Section <a href="#sec:presence-density">Presence and Density</a> provides the configuration of PTRS, including its presence and density in the time and frequency domain. The PTRS port association is presented in Section <a href="#sec:port-association">Port Association</a>. Then, sequence generation and resource mapping follows in Section <a href="#sec:sequ-gener-reso">Sequence Generation and Resource Mapping</a>. In Section <a href="#sec:pn-estim-compl">Phase Noise Estimation and Complementation</a>, the methodology of phase noise estimation and complementation are described in details. Finally, Section <a href="#sec:summary">Summary</a> summarizes the report.
</p>

<p>
For clear description, following denotation conventions are adopted throughout the document. \(\otimes\) is the operator of circular convolution.
</p>
</div>
</div>

<div id="outline-container-org71ff541" class="outline-2">
<h2 id="sec:phase-noise-models">Phase Noise and Models</h2>
<div class="outline-text-2" id="text-sec:phase-noise-models">
<p>
As its name implies, a phase noise model is utilized to depict the behavior and the property of the phase noise. In fact, phase noise modelling plays an extremely important role in the estimation and complementation of the phase noise as well as the design of PTRS.
</p>

<p>
In order to accurately describe the variation and fluctuation of the phase noise in a statistic sense, phase noise modelling was intensively discussed. Based on the numerous measurement and evaluation of the realistic phase noise, there were totally 11 models proposed in RAN1 meeting #85. Finally, targetting for fair performance evaluation and
comparison of different candidate designs and solusions, the phase noise modelling converged into 4 mainstream models \cite{r1-164041, r1-165005, r1-163984, mmmagic}.
</p>

<p>
Without loss of generality, we take one OFDM symbol for instance to reveal the impact of phase noise. The actual output of an oscillator can be denoted by
</p>
\begin{align}
  \widetilde{x}(n) = x(n) \cdot \exp[j\phi(n)], \label{eq:pn-time}
\end{align}
<p>
where \(x(n)\) is the desired signal without any contamination of phase noise and \(\phi(n)\) the time-varying phase noise at time instant \(n\), \(n = 1, 2, \ldots, N\), where \(N\) is the FFT size for the OFDM symbol. After FFT, the equation (\ref{eq:pn-time}) becomes
</p>
\begin{align}
  \widetilde{X}(k) &= X(k) \otimes \Phi(k) \nonumber \\
  &= X(k) \cdot \Phi(0) + \sum_{i=1, i\neq k}^NX(i) \cdot \Phi(k - i), \label{eq:pn-freq}
\end{align}
<p>
where \(\widetilde{X}(k)\), \(X(k)\), and \(\Phi(k)\) are respectively the FFT of \(\widetilde{x}(n)\), \(x(n)\), and \(\exp[j\phi(n)]\), i.e.,
</p>
\begin{align*}
  \widetilde{X}(k) &= \sum_{n=1}^N \widetilde{x}(n) \cdot \exp\left(j\frac{2\pi}{N}kn\right) \\
  X(k) &= \sum_{n=1}^N x(n) \cdot \exp\left(j\frac{2\pi}{N}kn\right) \\
  \Phi(k) &= \sum_{n=1}^N \exp\left\{j\left[\phi(n) + \frac{2\pi}{N}kn\right]\right\}.
\end{align*}

<p>
According to (\ref{eq:pn-freq}), the influence of phase noise can be divided into two aspects, a multiplicative \(\Phi(0)\) and an additive \(\sum_{i=1, i\neq k}^NX(i) \cdot \Phi(k - i)\), termed <i>common phase error (CPE)</i> and <i>inter-carrier interference (ICI)</i> respectively. For CPE, it essentially rotates the whole constellation with \(\Phi(0)\), and Figure <a href="#orgaa80011">1</a> illustrates the impact on a 16QAM constellation. A 64QAM constellation impacted by ICI can be illustrated by Figure <a href="#org50024c8">2</a>.
</p>

<div id="orgaa80011" class="figure">
<p><img src="cpe.png" alt="cpe.png">
</p>
<p><span class="figure-number">Figure 1: </span>A 16QAM constellation contaminated by CPE</p>
</div>


<div id="org50024c8" class="figure">
<p><img src="ici.png" alt="ici.png">
</p>
<p><span class="figure-number">Figure 2: </span>A 64QAM constellation contaminated by ICI</p>
</div>
</div>
</div>
<div id="outline-container-orgf0c4d83" class="outline-2">
<h2 id="sec:presence-density"><span class="todo TODO">TODO</span> Presence and Density</h2>
<div class="outline-text-2" id="text-sec:presence-density">
</div>
</div>
<div id="outline-container-orgbdaf297" class="outline-2">
<h2 id="sec:port-association">Port Association</h2>
<div class="outline-text-2" id="text-sec:port-association">
<p>
In essence, as mentioned before, phase noise is generated by an oscillator. Therefore, the number of PTRS port in the downlink and uplink depends on the number of oscillator as well as the concrete implementation of the gNB and the UE, respectively. In other words, the number of PTRS port can be much smaller than that of DMRS port in the transmission. A PTRS port can corresponds with more than one DMRS ports and transmission layers. This is just the reason why there are at most two PTRS ports available in NR system.
</p>

<p>
In the case that a PTRS port is shared by more than one DMRS ports, theoretically the PTRS can be associated and mapped to any one of the corresponding DMRS ports. For the sake of precise phase noise estimation, irrespective of downlink or uplink, a PTRS port is expected to be transmitted over the DMRS port with the best radio condition. This section provides the detail that a PTRS port is associated and mapped to the best DMRS port in the downlink and uplink respectively.
</p>
</div>
<div id="outline-container-org201bc6b" class="outline-3">
<h3 id="downlink">Downlink</h3>
<div class="outline-text-3" id="text-downlink">
<p>
In the downlink, DMRS ports are divided into DMRS port groups according to the QCL relationship, i.e., QCL holds within each DMRS port group, but does not across different DMRS port groups. Given a DMRS port group, if it is configured with a PTRS port, all the component DMRS ports within the DMRS port group share the configured PTRS port.
</p>

<p>
As stated before, a PTRS port needs to be assocated and mapped to a unique DMRS port with the strongest transmission quality in the one or two corresponding DMRS port groups. For a gNB, it has to understand which DMRS port or which PDSCH layer is the target for PTRS port association. To this end, a UE reports a <i>layer index (LI)</i> to its serving gNB.
</p>

<p>
With the LI at hand, a gNB can associate the PTRS port to the strongest DMRS port before transmission. At the UE side, it also requires the knowledge of the DMRS port carrying PTRS port. Otherwise, it cannot locate the PTRS port and determine the exact port index of the carrying DMRS port, since the processing relating to PTRS usually precedes that of DMRS, i.e., phase noise must be estimated and complemented first before any time domain interpolation in the DMRS-based channel estimation, e.g., 2-dimension MMSE.
</p>

<p>
If explicit signaling is adopted to indicate the PTRS port association, e.g., introducing a dedicated field in the downlink DCI, additional signalling will be involved. From overhead reduction perspective, compared to explict signalling, implicit indication is more encouraged and preferred. Considering the fact that there are not CRS any longer and all the PDSCH layers are transmitted based on DMRS in the NR system, each PDSCH transmission is absolutely transparent to the target UE. In this case, a gNB can flexibly permute and reorder the PDSCH layers by exchanging the columns of the precoding matrix. What is more, such kind of behavior is a completely gNB implementation related issue, and consequently no specification effort is needed. In this way, in order to avoid the introduction of additional overhead for PTRS port association, a gNB can permute the precoding vector corresponding to the strongest DMRS port to a specific column position first and then map the PTRS port to the DMRS port corresponding to the aforementioned precoding vector. Without loss of generality, first column is selected as the specific column and the corresponding DMRS port which has the lowest port index in the DMRS port group is utilized to carry the PTRS port.
</p>
</div>
<div id="outline-container-org8614274" class="outline-4">
<h4 id="one-ptrs-port">One PTRS port</h4>
<div class="outline-text-4" id="text-one-ptrs-port">
<p>
If a UE is configured with one PTRS port, then the UE can be scheduled with one or two DMRS port group(s). The PTRS port association depends on the number of codeword scheduled for the UE, i.e.,
</p>
<ul class="org-ul">
<li>In single-codeword case, the PTRS port is associated to the DMRS port with the lowest port index.</li>
<li>In double-codeword case, the PTRS port is associated to the lowest-indexed DMRS port within the DMRS port group with higher MCS. Particularly, if the two codewords have equal MCS, the PTRS port is associated to the lowest-indexed DMRS port corresponding to the first codeword, i.e., codeword 0.</li>
</ul>

<p>
In the case of two DMRS port groups, all the DMRS ports from the two DMRS port groups share the one PTRS port. Once the PTRS port is associated to a determined DMRS port, different types of QCL relationship are established between the PTRS port and the both DMRS port groups.
</p>
<ul class="org-ul">
<li>The PTRS port and the DMRS port group containing the associated DMRS port are <i>Type-A</i> and <i>Type-D</i> QCLed.</li>
<li>The PTRS port and the DMRS port group not containing the associated DMRS port are <i>Type-B</i> QCLed.</li>
</ul>
</div>
</div>
<div id="outline-container-org7c98e44" class="outline-4">
<h4 id="two-ptrs-ports">Two PTRS ports</h4>
<div class="outline-text-4" id="text-two-ptrs-ports">
<p>
If a UE is configured with two PTRS ports, it is always scheduled with DMRS ports from two DMRS port groups. Each PTRS port corresponds with one DMRS port group, and is associated to the DMRS port with the lowest port index within its corresponding DMRS port group. Moreover, each PTRS and its corresponding DMRS port group are Type-A and Type-D QCLed.
</p>
</div>
</div>
</div>
<div id="outline-container-orgb87de8d" class="outline-3">
<h3 id="uplink"><span class="todo TODO">TODO</span> Uplink</h3>
<div class="outline-text-3" id="text-uplink">
</div>
</div>
</div>
<div id="outline-container-orgaca387a" class="outline-2">
<h2 id="sec:sequ-gener-reso"><span class="todo TODO">TODO</span> Sequence Generation and Resource Mapping</h2>
<div class="outline-text-2" id="text-sec:sequ-gener-reso">
</div>
</div>
<div id="outline-container-org3e6bf75" class="outline-2">
<h2 id="sec:pn-estim-compl">Phase Noise Estimation and Complementation</h2>
<div class="outline-text-2" id="text-sec:pn-estim-compl">
<p>
Due to its non-selective nature in the frequency domain, phase noise is estimated in the frequency domain through the whole bandwidth scheduled, and then interpolation is performed in the time domain for the CP-OFDM or DFT-S-OFDM symbols without PTRS. The procedure is different for different waveforms. Hence, the procedure is presented in details for CP-OFDM based and DFT-S-OFDM based transmission, respectively.
</p>
</div>
<div id="outline-container-org8d19cc3" class="outline-3">
<h3 id="cp-ofdm">CP-OFDM</h3>
<div class="outline-text-3" id="text-cp-ofdm">
<p>
For clear description, taking a PTRS port for instance, we suppose that a PTRS symbol \(x_{m, n}\) is transmitted over its associated DMRS port on a RE \((k_m, l_n)\), which corresponds to subcarrier \(k_m\) and OFDM symbol \(l_n\), i.e.,
</p>
\begin{align}
  y_{k_m, l_n} = H_{k_m, l_n} e^{j\theta_{l_n}} x_{m,n} + n_{k_m, l_n}, \quad m = 1, 2, \ldots, M; n = 1, 2, \ldots, N,
\end{align}
<p>
where \(y_{k_m, l_n}\), \(H_{k_m, l_n}\), and \(n_{k_m, l_n}\) are the received signal, channel fading, and the additive white Gaussian noise on RE \((k_m, l_n)\), respectively; \(\theta_{l_n}\) represents the phase noise on $l<sub>n</sub>$th OFDM symbol.
</p>

<p>
Since phase noise fluctuates as time, the impairment of phase noise can be completely complemented by a phase difference relative to a reference. Without loss of generality, we identify the phase noise on the first PTRS symbol as the reference, and the phase noise on the symbol is zero, i.e. \(\theta_{l_1} = 0\). Then, the phase noise on PTRS symbol \(l_n\) can be estimated according to
</p>
\begin{align}
  \hat{\theta}_{l_n} = \arg \sum_{m=1}^M \dfrac{y_{k_m, l_n}x_{m, n}^*}{y_{k_m, l_1}x_{m, 1}^*}, \quad n = 2, 3, \ldots, N.
\end{align}
<p>
Then, if the time density of the PTRS is less than 1, i.e., \(L_\text{PTRS} > 1\), the phase noise of the OFDM symbols without PTRS can be obtained by interpolation.
</p>
</div>
</div>
<div id="outline-container-org9331539" class="outline-3">
<h3 id="dft-s-ofdm">DFT-S-OFDM</h3>
<div class="outline-text-3" id="text-dft-s-ofdm">
<p>
In DFT-S-OFDM case, which is different from CP-OFDM waveform, the PTRS samples are inserted into PUSCH samples before the DFT operation, i.e., in the time domain. Accordingly, the phase noise should also be estimated and complemented in the time domain, i.e., after the IDFT processing. Taking \(X\) PTRS groups/chunks with each comprised of \(K\) samples for instance, the received signal can be expressed as
</p>
\begin{align}
  r_{m, g, l_n} = h_{m, g, l_n} e^{j\theta_{m, g, l_n}} x_{m, g, l_n} + n_{m, g, l_n}, \quad m = 1, 2, \ldots, K; g = 1, 2, \ldots, X,
\end{align}
<p>
where the subscript tuple \((m, g, l_n)\) means $m$th sample position within $g$th PTRS group in DFT-S-OFDM symbol \(l_n\); accordingly, \(x_{m, g, l_n}\), \(\theta_{m, g, l_n}\), \(r_{m, g, l_n}\), \(h_{m, g, l_n}\), and \(n_{m, g, l_n}\) are the PTRS sample, the phase noise, the received signal (after IDFT), the effective channel fading and the effective additive white Gaussian noise at the sample position.
</p>
</div>
</div>
</div>
<div id="outline-container-orge36c31b" class="outline-2">
<h2 id="sec:summary"><span class="todo TODO">TODO</span> Summary</h2>
<div class="outline-text-2" id="text-sec:summary">
</div>
</div>
</div>
</body>
</html>
