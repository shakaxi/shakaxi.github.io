<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2019-09-04 Wed 21:25 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>NR - Phase Tracking Reference Signal (PTRS)</title>
<meta name="generator" content="Org mode">
<meta name="author" content="shaka">
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="default.css"/>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2019 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">NR - Phase Tracking Reference Signal (PTRS)</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org1e441f9">Introduction</a></li>
<li><a href="#sec:pn-model">Phase Noise and Models</a></li>
<li><a href="#sec:presence-density">Presence and Density</a>
<ul>
<li><a href="#org9585aa9">Downlink</a></li>
<li><a href="#org782c36f">Uplink - CP-OFDM</a></li>
<li><a href="#orgbaf5812">Uplink - DFT-S-OFDM</a></li>
<li><a href="#orgb30cf73">Some Miscellaneous for CP-OFDM</a></li>
</ul>
</li>
<li><a href="#sec:port-num">Port Number</a>
<ul>
<li><a href="#org993d795">Downlink</a></li>
<li><a href="#org20af468">Uplink</a>
<ul>
<li><a href="#org6b34832">CP-OFDM</a>
<ul>
<li><a href="#org6852a26">Non-codebook based transmission</a></li>
<li><a href="#orgf216b0e">Codebook-based transmission</a></li>
</ul>
</li>
<li><a href="#org6556421">DFT-S-OFDM</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec:port-association">Port Association</a>
<ul>
<li><a href="#orgf00d19c">Downlink</a></li>
<li><a href="#org29c7b4c">Uplink</a></li>
</ul>
</li>
<li><a href="#sec:res-map">Resource Mapping</a>
<ul>
<li><a href="#org31c2bfb">CP-OFDM</a></li>
<li><a href="#org6b3ac88">DFT-S-OFDM</a></li>
</ul>
</li>
<li><a href="#sec:seq-gen">Sequence Generation</a>
<ul>
<li><a href="#orgaa5d722">DFT-S-OFDM</a></li>
<li><a href="#org024ee20">CP-OFDM</a></li>
</ul>
</li>
<li><a href="#sec:pn-estim-compl">Phase Noise Estimation and Complementation</a>
<ul>
<li><a href="#cp-ofdm">CP-OFDM</a></li>
<li><a href="#dft-s-ofdm">DFT-S-OFDM</a></li>
</ul>
</li>
<li><a href="#sec:summary">Summary</a></li>
</ul>
</div>
</div>

<div id="outline-container-org1e441f9" class="outline-2">
<h2 id="org1e441f9">Introduction</h2>
<div class="outline-text-2" id="text-org1e441f9">
<p>
Targetting for the great goal of the 5th generation (5G) system, the <i>new radio (NR)</i> system, proposed by the 3rd generation partner project (3GPP), has employed a variety of cutting-edge technologies, including advanced channel coding schemes, e.g., low density parity code (LDPC) and polar code, higher-order modulation schemes, e.g., 256QAM, etc. Considering the fact that the lower frequency spectrum has already been so crowded and overutilized, NR decided to explore higher frequency band, e.g., million meter wave (mmWave). After all, much richer spectrum resources are available at higher frequency bands than lower frequency spectrum.
</p>

<p>
As is well-known, high frequency transmission suffers severe attenuation loss in the propagation, which remarkably limits the effective coverage and transmission distance. Fortunately, higher frequency spectrum has shorter wave length. Given an aperture size, much more antennas can be equipped in higher frequency transmission than those in lower frequency transmission. In this way, more antennas can yield larger beamforming gain and complement the attenuation loss in the transmission over the higher frequency bands. In a word, higher frequency enables the dense deployment of antennas, i.e., <i>massive multi-input multi-output (M-MIMO)</i>, or equivalently <i>large-scale MIMO (LS-MIMO)</i>; while M-MIMO extends the transmission distance and coverage of the higher frequency bands. Therefore, M-MIMO and higher frequency transmission are usually jointly utilized and have been the focus of the research and discussion in the 3GPP standardization.
</p>

<p>
Generally, an oscillator always produces phase noise, which is essentially an impairment of the oscillator. Nevertheless, the phase noise soars as the operation frequency grows. In the NR system, which operates on higher frequency spectrum, the impact of phase noise cannot be ignored. Instead, the phase noise must be accurately estimated and complemented before data detection. To this end, a dedicated reference signal, termed <i>phase tracking reference signal (PTRS)</i> has been proposed to track the fluctuation of the phase noise.
</p>

<p>
This report intends to cover everything detail relating to PTRS. The remaining of this report is structured as follows. Section <a href="#sec:pn-model">Phase Noise and Models</a> briefly introduces the models of phase noise, and Section <a href="#sec:presence-density">Presence and Density</a> provides the configuration of PTRS, including its presence and density in the time and frequency domain. The number of PTRS supported is given in Section <a href="#sec:port-num">Port Number</a>. The PTRS port association follows in Section <a href="#sec:port-association">Port Association</a>. Then, resource mapping and sequence generation are presented in Section <a href="#sec:res-map">Resource Mapping</a> and <a href="#sec:seq-gen">Sequence Generation</a> respectively. In Section <a href="#sec:pn-estim-compl">Phase Noise Estimation and Complementation</a>, the methodology of phase noise estimation and complementation are described in details. Finally, Section <a href="#sec:summary">Summary</a> summarizes the report.
</p>

<p>
For clear description, following denotation conventions are adopted throughout the document. \(\otimes\) is the operator of circular convolution.
</p>
</div>
</div>

<div id="outline-container-org2c5bc35" class="outline-2">
<h2 id="sec:pn-model"><a id="org2c5bc35"></a>Phase Noise and Models</h2>
<div class="outline-text-2" id="text-sec:pn-model">
<p>
As its name implies, a phase noise model is utilized to depict the behavior and the property of the phase noise. In fact, phase noise modelling plays an extremely important role in the estimation and complementation of the phase noise as well as the design of PTRS.
</p>

<p>
In order to accurately describe the variation and fluctuation of the phase noise in a statistic sense, phase noise modelling was intensively discussed. Based on the numerous measurement and evaluation of the realistic phase noise, there were totally 11 models proposed in RAN1 meeting #85. Finally, targetting for fair performance evaluation and comparison of different candidate designs and solusions, the phase noise modelling converged into 4 mainstream models \cite{r1-164041, r1-165005, r1-163984, mmmagic}.
</p>

<p>
Without loss of generality, we take one OFDM symbol for instance to reveal the impact of phase noise. The actual output of an oscillator can be denoted by
</p>
\begin{align}
  \widetilde{x}(n) = x(n) \cdot \exp[j\phi(n)], \label{eq:pn-time}
\end{align}
<p>
where \(x(n)\) is the desired signal without any contamination of phase noise and \(\phi(n)\) the time-varying phase noise at time instant \(n\), \(n = 1, 2, \ldots, N\), where \(N\) is the FFT size for the OFDM symbol. After FFT, the equation (\ref{eq:pn-time}) becomes
</p>
\begin{align}
  \widetilde{X}(k) &= X(k) \otimes \Phi(k) \nonumber \\
  &= X(k) \cdot \Phi(0) + \sum_{i=1, i\neq k}^NX(i) \cdot \Phi(k - i), \label{eq:pn-freq}
\end{align}
<p>
where \(\widetilde{X}(k)\), \(X(k)\), and \(\Phi(k)\) are respectively the FFT of \(\widetilde{x}(n)\), \(x(n)\), and \(\exp[j\phi(n)]\), i.e.,
</p>
\begin{align*}
  \widetilde{X}(k) &= \sum_{n=1}^N \widetilde{x}(n) \cdot \exp\left(j\frac{2\pi}{N}kn\right) \\
  X(k) &= \sum_{n=1}^N x(n) \cdot \exp\left(j\frac{2\pi}{N}kn\right) \\
  \Phi(k) &= \sum_{n=1}^N \exp\left\{j\left[\phi(n) + \frac{2\pi}{N}kn\right]\right\}.
\end{align*}

<p>
According to (\ref{eq:pn-freq}), the influence of phase noise can be divided into two aspects, a multiplicative \(\Phi(0)\) and an additive \(\sum_{i=1, i\neq k}^NX(i) \cdot \Phi(k - i)\), termed <i>common phase error (CPE)</i> and <i>inter-carrier interference (ICI)</i> respectively. For CPE, it essentially rotates the whole constellation with \(\Phi(0)\), and Figure <a href="#org609cc10">1</a> illustrates the impact on a 16QAM constellation. A 64QAM constellation impacted by ICI can be illustrated by Figure <a href="#org2af1656">2</a>.
</p>

<div id="org609cc10" class="figure">
<p><img src="cpe.png" alt="cpe.png">
</p>
<p><span class="figure-number">Figure 1: </span>A 16QAM constellation contaminated by CPE</p>
</div>


<div id="org2af1656" class="figure">
<p><img src="ici.png" alt="ici.png">
</p>
<p><span class="figure-number">Figure 2: </span>A 64QAM constellation contaminated by ICI</p>
</div>

<p>
From system performance perspective, CPE is more harmful than ICI, and is prioritized to be complemented. Its frequency-flat property gives rise to its dense distribution in the time domain and sparse scattering in the frequency domain.
</p>
</div>
</div>
<div id="outline-container-orgc48ebb6" class="outline-2">
<h2 id="sec:presence-density"><a id="orgc48ebb6"></a>Presence and Density</h2>
<div class="outline-text-2" id="text-sec:presence-density">
</div>
<div id="outline-container-org9585aa9" class="outline-3">
<h3 id="org9585aa9">Downlink</h3>
<div class="outline-text-3" id="text-org9585aa9">
<ul class="org-ul">
<li>If <i>phaseTrackingRS</i> in <i>DMRS-DownlinkConfig</i> is configured,
<ul class="org-ul">
<li>If RNTI equals MCS-C-RNTI, C-RNTI, or CS-RNTI,
<ul class="org-ul">
<li>If at least <i>timeDensity</i> or <i>frequencyDensity</i> in <i>PTRS-DownlinkConfig</i> is configured, the time domain density (L<sub>PT-RS</sub>) is a function of scheduled MCS (see Table <a href="#org6ca521a">1</a>), and frequency domain density (K<sub>PT-RS</sub>) is a function of scheduled bandwidth (see Table <a href="#orgfc48b48">2</a>). If not configured, the default values, L<sub>PT-RS</sub> = 1, K<sub>PT-RS</sub> = 2, apply.</li>
<li>If neither of <i>timeDensity</i> and <i>frequencyDensity</i> in <i>PTRS-DownlinkConfig</i> is configured,
<ul class="org-ul">
<li>For QPSK or scheduled bandwidth &lt; 3 RB's, PTRS is not present;</li>
<li>Else, L<sub>PT-RS</sub> = 1, K<sub>PT-RS</sub> = 2.</li>
</ul></li>
</ul></li>
<li>If RNTI equals RA-RNTI, SI-RNTI, or P-RNTI, PTRS is not present.</li>
</ul></li>
<li>Else, PTRS is not present.</li>
</ul>

<table id="org6ca521a" align="center" width="800px">
<caption class="t-above"><span class="table-number">Table 1:</span> Time-domain density for CP-OFDM (the thresholds are configured by <i>timeDensity</i>)</caption>

<colgroup>
<col  class="org-center">

<col  class="org-center">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-center">Scheduled MCS</th>
<th scope="col" class="org-center">L<sub>PT-RS</sub></th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-center">I<sub>MCS</sub> &lt; ptrs-MCS<sub>1</sub></td>
<td class="org-center">Not present</td>
</tr>

<tr>
<td class="org-center">ptrs-MCS<sub>1</sub> &le; I<sub>MCS</sub> &lt; ptrs-MCS<sub>2</sub></td>
<td class="org-center">4</td>
</tr>

<tr>
<td class="org-center">ptrs-MCS<sub>2</sub> &le; I<sub>MCS</sub> &lt; ptrs-MCS<sub>3</sub></td>
<td class="org-center">2</td>
</tr>

<tr>
<td class="org-center">ptrs-MCS<sub>3</sub> &le; I<sub>MCS</sub> &lt; ptrs-MCS<sub>4</sub></td>
<td class="org-center">1</td>
</tr>
</tbody>
</table>

<table id="orgfc48b48" align="center" width="1000px">
<caption class="t-above"><span class="table-number">Table 2:</span> Frequency-domain density for CP-OFDM (the thresholds are configured by <i>frequencyDensity</i>)</caption>

<colgroup>
<col  class="org-center">

<col  class="org-center">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-center">Scheduled bandwidth</th>
<th scope="col" class="org-center">K<sub>PT-RS</sub></th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-center">N<sub>RB</sub> &lt; N<sub>RB0</sub></td>
<td class="org-center">Not present</td>
</tr>

<tr>
<td class="org-center">N<sub>RB0</sub> &le; N<sub>RB</sub> &lt; N<sub>RB1</sub></td>
<td class="org-center">2</td>
</tr>

<tr>
<td class="org-center">N<sub>RB1</sub> &le; N<sub>RB</sub></td>
<td class="org-center">4</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-org782c36f" class="outline-3">
<h3 id="org782c36f">Uplink - CP-OFDM</h3>
<div class="outline-text-3" id="text-org782c36f">
<ul class="org-ul">
<li>If <i>phaseTrackingRS</i> in <i>DMRS-UplinkConfig</i> is configured,
<ul class="org-ul">
<li>If RNTI equals MCS-C-RNTI, C-RNTI, CS-RNTI, or SP-CSI-RNTI,
<ul class="org-ul">
<li>If at least <i>timeDensity</i> or <i>frequencyDensity</i> in <i>PTRS-UplinkConfig</i> is configured, the time domain density (L<sub>PT-RS</sub>) is a function of scheduled MCS (see Table <a href="#org6ca521a">1</a>), and frequency domain density (K<sub>PT-RS</sub>) is a function of scheduled bandwidth (see Table <a href="#orgfc48b48">2</a>). If not configured, the default values, L<sub>PT-RS</sub> = 1, K<sub>PT-RS</sub> = 2, apply.</li>
<li>If neither of <i>timeDensity</i> and <i>frequencyDensity</i> in <i>PTRS-UplinkConfig</i> is configured, L<sub>PT-RS</sub> = 1, K<sub>PT-RS</sub> = 2.</li>
</ul></li>
<li>Else, PTRS is not present.</li>
</ul></li>
<li>Else, PTRS is not present.</li>
</ul>
</div>
</div>
<div id="outline-container-orgbaf5812" class="outline-3">
<h3 id="orgbaf5812">Uplink - DFT-S-OFDM</h3>
<div class="outline-text-3" id="text-orgbaf5812">
<ul class="org-ul">
<li>If <i>transformPrecoderEnabled</i> in <i>PTRS-UplinkConfig</i> is configured,
<ul class="org-ul">
<li>If <i>timeDensityTransformPrecoding</i> is configured to 2, L<sub>PT-RS</sub> = 2;</li>
<li>Else, L<sub>PT-RS</sub> = 1.</li>
<li>With <i>sampleDensity</i> configured, the group pattern of PTRS is a function of scheduled bandwidth (see Table <a href="#orgc4d5a17">3</a>).</li>
</ul></li>
</ul>

<table id="orgc4d5a17" align="center" width="800px">
<caption class="t-above"><span class="table-number">Table 3:</span> PTRS group pattern for DFT-S-OFDM (the thresholds are configured by <i>SampleDensity</i>)</caption>

<colgroup>
<col  class="org-center">

<col  class="org-center">

<col  class="org-center">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-center">Scheduled bandwidth</th>
<th scope="col" class="org-center">Group number</th>
<th scope="col" class="org-center">Group size</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-center">N<sub>RB0</sub> &le; N<sub>RB</sub> &lt; N<sub>RB1</sub></td>
<td class="org-center">2</td>
<td class="org-center">2</td>
</tr>

<tr>
<td class="org-center">N<sub>RB1</sub> &le; N<sub>RB</sub> &lt; N<sub>RB2</sub></td>
<td class="org-center">2</td>
<td class="org-center">4</td>
</tr>

<tr>
<td class="org-center">N<sub>RB2</sub> &le; N<sub>RB</sub> &lt; N<sub>RB3</sub></td>
<td class="org-center">4</td>
<td class="org-center">2</td>
</tr>

<tr>
<td class="org-center">N<sub>RB3</sub> &le; N<sub>RB</sub> &lt; N<sub>RB4</sub></td>
<td class="org-center">4</td>
<td class="org-center">4</td>
</tr>

<tr>
<td class="org-center">N<sub>RB4</sub> &le; N<sub>RB</sub></td>
<td class="org-center">8</td>
<td class="org-center">4</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-orgb30cf73" class="outline-3">
<h3 id="orgb30cf73">Some Miscellaneous for CP-OFDM</h3>
<div class="outline-text-3" id="text-orgb30cf73">
<ul class="org-ul">
<li>Threshold ptrs-MCS<sub>4</sub> is not explicitly configured, and it equals the lowest MCS level for retransmission.</li>
<li>For retransmission, the time-domain density is determined by the MCS in the initial transmission.</li>
<li>Given a minislot comprising of L OFDM symbols, if L<sub>PT-RS</sub> &ge; L, PTRS is not present.</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org8fc3d32" class="outline-2">
<h2 id="sec:port-num"><a id="org8fc3d32"></a>Port Number</h2>
<div class="outline-text-2" id="text-sec:port-num">
<p>
In essence, as mentioned before, phase noise is generated by an oscillator. The number of PTRS port in the downlink and uplink depends on the number of oscillator as well as the concrete implementation of the gNB and the UE, respectively. Therefore, it is not necessary to configure a PTRS port for each DMRS port. Instead, one or more DMRS ports corresponding to one oscillator can share one PTRS port.
</p>
</div>
<div id="outline-container-org993d795" class="outline-3">
<h3 id="org993d795">Downlink</h3>
<div class="outline-text-3" id="text-org993d795">
<p>
In NR release 15, there is at most only one PTRS port in the downlink.
</p>
</div>
</div>
<div id="outline-container-org20af468" class="outline-3">
<h3 id="org20af468">Uplink</h3>
<div class="outline-text-3" id="text-org20af468">
</div>
<div id="outline-container-org6b34832" class="outline-4">
<h4 id="org6b34832">CP-OFDM</h4>
<div class="outline-text-4" id="text-org6b34832">
<p>
In CP-OFDM case, there are up to two PTRS ports, indicated by <i>maxNrofPorts</i> in <i>PTRS-UplinkConfig</i>.
</p>

<p>
If a UE supports full-coherent transmission, only single PTRS port is supported if present.
</p>
</div>
<div id="outline-container-org6852a26" class="outline-5">
<h5 id="org6852a26">Non-codebook based transmission</h5>
<div class="outline-text-5" id="text-org6852a26">
<p>
The actual number of PTRS port is determined by sounding reference signal resource indicator (SRI), since each SRS resource is configured with a PTRS port index by <i>ptrs-PortIndex</i> in <i>SRS-Config</i>, if <i>phaseTrackingRS</i> is configured in <i>DMRS-UplinkConfig</i>.
</p>
</div>
</div>
<div id="outline-container-orgf216b0e" class="outline-5">
<h5 id="orgf216b0e">Codebook-based transmission</h5>
<div class="outline-text-5" id="text-orgf216b0e">
<p>
In partial-coherent or non-coherent case, the actual number of PTRS ports depends on TPMI and/or TRI in DCI format 0-1.
</p>
<ul class="org-ul">
<li>PTRS port 0 is shared by SRS port 1000 and 1002.</li>
<li>PTRS port 1 is shared by SRS port 1001 and 1003.</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org6556421" class="outline-4">
<h4 id="org6556421">DFT-S-OFDM</h4>
<div class="outline-text-4" id="text-org6556421">
<p>
For DFT-S-OFDM, only single-layer transmission is supported. Hence, at most one PTRS port is present.
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-orga24b595" class="outline-2">
<h2 id="sec:port-association"><a id="orga24b595"></a>Port Association</h2>
<div class="outline-text-2" id="text-sec:port-association">
<p>
If a PTRS port is shared by more than one DMRS ports, the PTRS port and the DMRS ports are <i>Type-A</i> and <i>Type-D</i> QCLed. Theoretically, the PTRS can be associated and mapped to any one of the corresponding DMRS ports. However, for the sake of precise phase noise estimation, irrespective of downlink or uplink, a PTRS port is expected to be transmitted over the DMRS port with the best radio condition.
</p>
</div>
<div id="outline-container-orgf00d19c" class="outline-3">
<h3 id="orgf00d19c">Downlink</h3>
<div class="outline-text-3" id="text-orgf00d19c">
<p>
In order to facilitate the PTRS port association, a UE reports a <i>layer index (LI)</i> to its serving gNB, which indicates the index of the layer with best quality.
</p>

<p>
With LI at hand, a gNB can always associate the PTRS port to the DMRS port with the best channel quality. Moreover, for the purpose of signalling overhead reduction, a gNB can permute and reorder the precoding vectors until the lowest indexed DMRS port has the most excellent channel quality. Clearly, the operation is a completely gNB implementation related issue without any specification effort. To sum up, the PTRS port is associated to a unique DMRS port as follows.
</p>
<ul class="org-ul">
<li>In single-codeword case, the PTRS port is assocated to the lowest-indexed DMRS port.</li>
<li>For double-codeword, the PTRS port is associated to the lowest-indexed DMRS port corresponding to the codeword with highest MCS level.</li>
</ul>
</div>
</div>
<div id="outline-container-org29c7b4c" class="outline-3">
<h3 id="org29c7b4c">Uplink</h3>
<div class="outline-text-3" id="text-org29c7b4c">
<p>
The association between PTRS ports and DMRS ports is signalled by the field of <i>PTRS-DMRS assocation</i> in DCI format 0-1.
</p>
<ul class="org-ul">
<li>If at least one of the following condition is satisfied, <i>PTRS-DMRS assocation</i> is not present.
<ul class="org-ul">
<li>CP-OFDM: <i>PTRS-UplinkConfig</i> is not configured.</li>
<li>DFT-S-OFDM</li>
<li><i>maxRank</i> = 1</li>
</ul></li>
<li>Else, 2-bit <i>PTRS-DMRS assocation</i> is present (see Tables <a href="#orgd4c90d7">4</a> and <a href="#orge14561c">5</a> for one and two PTRS ports, respectively)</li>
</ul>

<table id="orgd4c90d7" align="center" width="600px">
<caption class="t-above"><span class="table-number">Table 4:</span> PTRS-DMRS association for UL PTRS port 0</caption>

<colgroup>
<col  class="org-center">

<col  class="org-center">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-center">Value</th>
<th scope="col" class="org-center">DMRS port</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-center">0</td>
<td class="org-center">1st scheduled DMRS port</td>
</tr>

<tr>
<td class="org-center">1</td>
<td class="org-center">2nd scheduled DMRS port</td>
</tr>

<tr>
<td class="org-center">2</td>
<td class="org-center">3rd scheduled DMRS port</td>
</tr>

<tr>
<td class="org-center">3</td>
<td class="org-center">4th scheduled DMRS port</td>
</tr>
</tbody>
</table>

<table id="orge14561c" align="center" width="1000px">
<caption class="t-above"><span class="table-number">Table 5:</span> PTRS-DMRS association for UL PTRS ports 0 and 1</caption>

<colgroup>
<col  class="org-center">

<col  class="org-center">

<col  class="org-center">

<col  class="org-center">

<col  class="org-center">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-center">Value of MSB</th>
<th scope="col" class="org-center">DMRS port</th>
<th scope="col" class="org-center">&#xa0;</th>
<th scope="col" class="org-center">Value of LSB</th>
<th scope="col" class="org-center">DMRS port</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-center">0</td>
<td class="org-center">1st DMRS port which shares PTRS port 0</td>
<td class="org-center">&#xa0;</td>
<td class="org-center">0</td>
<td class="org-center">1st DMRS port which shares PTRS port 1</td>
</tr>

<tr>
<td class="org-center">1</td>
<td class="org-center">2nd DMRS port which shares PTRS port 0</td>
<td class="org-center">&#xa0;</td>
<td class="org-center">1</td>
<td class="org-center">2nd DMRS port which shares PTRS port 1</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="outline-container-orgad688a5" class="outline-2">
<h2 id="sec:res-map"><a id="orgad688a5"></a>Resource Mapping</h2>
<div class="outline-text-2" id="text-sec:res-map">
</div>
<div id="outline-container-org31c2bfb" class="outline-3">
<h3 id="org31c2bfb">CP-OFDM</h3>
<div class="outline-text-3" id="text-org31c2bfb">
<p>
The target subcarriers for PTRS mapping can be expressed as
</p>
\begin{align*}
  k = k_\text{ref}^\text{RE} + (iK_\text{PT-RS} + k_\text{ref}^\text{RB})N_\text{sc}^\text{RB}, \quad i = 0, 1, \ldots,
\end{align*}
<p>
where
</p>
<ul class="org-ul">
<li>\(k_\text{ref}^\text{RE}\) is subcarrier-level offset, indicated by <i>resourceElementOffset</i> in <i>PTRS-DownlinkConfig</i> as shown in Table <a href="#org59bac5b">6</a>.</li>
</ul>
<table id="org59bac5b" align="center" width="800px">
<caption class="t-above"><span class="table-number">Table 6:</span> RE-level offset</caption>

<colgroup>
<col  class="org-center">

<col  class="org-center">

<col  class="org-center">

<col  class="org-center">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-center">DMRS antenna port</th>
<th scope="col" class="org-center"><i>resourceElementOffset</i></th>
<th scope="col" class="org-center">\(k_\text{ref}^\text{RE}\) for type-1 DMRS</th>
<th scope="col" class="org-center">\(k_\text{ref}^\text{RE}\) for type-2 DMRS</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-center">1000</td>
<td class="org-center">00</td>
<td class="org-center">0</td>
<td class="org-center">0</td>
</tr>

<tr>
<td class="org-center">&#xa0;</td>
<td class="org-center">01</td>
<td class="org-center">2</td>
<td class="org-center">1</td>
</tr>

<tr>
<td class="org-center">&#xa0;</td>
<td class="org-center">10</td>
<td class="org-center">6</td>
<td class="org-center">6</td>
</tr>

<tr>
<td class="org-center">&#xa0;</td>
<td class="org-center">11</td>
<td class="org-center">8</td>
<td class="org-center">7</td>
</tr>

<tr>
<td class="org-center">1001</td>
<td class="org-center">00</td>
<td class="org-center">2</td>
<td class="org-center">1</td>
</tr>

<tr>
<td class="org-center">&#xa0;</td>
<td class="org-center">01</td>
<td class="org-center">4</td>
<td class="org-center">6</td>
</tr>

<tr>
<td class="org-center">&#xa0;</td>
<td class="org-center">10</td>
<td class="org-center">8</td>
<td class="org-center">7</td>
</tr>

<tr>
<td class="org-center">&#xa0;</td>
<td class="org-center">11</td>
<td class="org-center">10</td>
<td class="org-center">0</td>
</tr>

<tr>
<td class="org-center">1002</td>
<td class="org-center">00</td>
<td class="org-center">1</td>
<td class="org-center">2</td>
</tr>

<tr>
<td class="org-center">&#xa0;</td>
<td class="org-center">01</td>
<td class="org-center">3</td>
<td class="org-center">3</td>
</tr>

<tr>
<td class="org-center">&#xa0;</td>
<td class="org-center">10</td>
<td class="org-center">7</td>
<td class="org-center">8</td>
</tr>

<tr>
<td class="org-center">&#xa0;</td>
<td class="org-center">11</td>
<td class="org-center">9</td>
<td class="org-center">9</td>
</tr>

<tr>
<td class="org-center">1003</td>
<td class="org-center">00</td>
<td class="org-center">3</td>
<td class="org-center">3</td>
</tr>

<tr>
<td class="org-center">&#xa0;</td>
<td class="org-center">01</td>
<td class="org-center">5</td>
<td class="org-center">8</td>
</tr>

<tr>
<td class="org-center">&#xa0;</td>
<td class="org-center">10</td>
<td class="org-center">9</td>
<td class="org-center">9</td>
</tr>

<tr>
<td class="org-center">&#xa0;</td>
<td class="org-center">11</td>
<td class="org-center">11</td>
<td class="org-center">2</td>
</tr>

<tr>
<td class="org-center">1004</td>
<td class="org-center">00</td>
<td class="org-center">-</td>
<td class="org-center">4</td>
</tr>

<tr>
<td class="org-center">&#xa0;</td>
<td class="org-center">01</td>
<td class="org-center">-</td>
<td class="org-center">5</td>
</tr>

<tr>
<td class="org-center">&#xa0;</td>
<td class="org-center">10</td>
<td class="org-center">-</td>
<td class="org-center">10</td>
</tr>

<tr>
<td class="org-center">&#xa0;</td>
<td class="org-center">11</td>
<td class="org-center">-</td>
<td class="org-center">11</td>
</tr>

<tr>
<td class="org-center">1005</td>
<td class="org-center">00</td>
<td class="org-center">-</td>
<td class="org-center">5</td>
</tr>

<tr>
<td class="org-center">&#xa0;</td>
<td class="org-center">01</td>
<td class="org-center">-</td>
<td class="org-center">10</td>
</tr>

<tr>
<td class="org-center">&#xa0;</td>
<td class="org-center">10</td>
<td class="org-center">-</td>
<td class="org-center">11</td>
</tr>

<tr>
<td class="org-center">&#xa0;</td>
<td class="org-center">11</td>
<td class="org-center">-</td>
<td class="org-center">4</td>
</tr>
</tbody>
</table>
<ul class="org-ul">
<li>\(k_\text{ref}^\text{RB}\) is PRB-level offset.</li>
</ul>
\begin{align*}
  k_\text{ref}^\text{RB} = \begin{cases}
      n_\text{RNTI} \mod K_\text{PT-RS}, & N_\text{RB} \mod K_\text{PT-RS} = 0; \\
      n_\text{RNTI} \mod (N_\text{RB} \mod K_\text{PT-RS}), & \text{otherwise}.
\end{cases}
\end{align*}
</div>
</div>
<div id="outline-container-org6b3ac88" class="outline-3">
<h3 id="org6b3ac88">DFT-S-OFDM</h3>
<div class="outline-text-3" id="text-org6b3ac88">
<p>
In DFT-S-OFDM case, PTRS samples are inserted before DFT operation, a.k.a. pre-DFT. Given a OFDM symbol with PTRS, PTRS samples are divided into a series of chunks/groups and then scattered in the PUSCH samples prior to DFT. The pattern depends on the number of samples in each group (\(N_\text{samp}^\text{group}\)) and the number of group (\(N_{\text{group}}^{\text{PT-RS}}\)), as shown in Table <a href="#orgc018ec1">7</a>, where letters \(M, H, T\) mean the PTRS group is respectively inserted in the <i>middle</i>, <i>head</i>, and <i>tail</i> of the corresponding PUSCH sample segment.
</p>
<table id="orgc018ec1" align="center" width="400px">
<caption class="t-above"><span class="table-number">Table 7:</span> PTRS pattern for DFT-S-OFDM</caption>

<colgroup>
<col  class="org-center">

<col  class="org-center">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-center">\(N_\text{samp}^\text{group}\)</th>
<th scope="col" class="org-center">Pattern</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-center">2</td>
<td class="org-center">\(\underbrace{M\ldots M}_{N_{\text{group}}^{\text{PT-RS}}}\)</td>
</tr>

<tr>
<td class="org-center">4</td>
<td class="org-center">\(H\underbrace{M\ldots M}_{N_{\text{group}}^{\text{PT-RS}}-2}T\)</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="outline-container-orge2c9f90" class="outline-2">
<h2 id="sec:seq-gen"><a id="orge2c9f90"></a>Sequence Generation</h2>
<div class="outline-text-2" id="text-sec:seq-gen">
</div>
<div id="outline-container-orgaa5d722" class="outline-3">
<h3 id="orgaa5d722">DFT-S-OFDM</h3>
<div class="outline-text-3" id="text-orgaa5d722">
<p>
PTRS samples are generated according to
\[
  r_m(m^{\prime}) = w(k^{\prime}) \frac{1 + j}{\sqrt{2}}[1 - 2c(m^{\prime})]e^{j\frac{\pi}{2}(m \mod 2)},
\]
where
</p>
<ul class="org-ul">
<li>\(c(\cdot)\) is a Gold sequence initialized with \(c_{\text{init}} = [2^{17}(N_{\text{symb}}^{\text{slot}} n_{s,f}^{\mu} + \ell + 1)(2N_{\text{ID}} + 1) + 2 N_{\text{ID}}] \mod 2^{31}\).</li>
<li>\(m\) is the global index of a PTRS sample with PUSCH samples considered.</li>
<li>\(m^{\prime} = N_{\text{samp}}^{\text{group}} s^{\prime} + k^{\prime}\) is the intra-sequence index of a PTRS sample.</li>
<li>\(s^{\prime} = 0, 1, \ldots, N_{\text{group}}^{\text{PT-RS}} - 1\) are the indices of PTRS groups.</li>
<li>\(k^{\prime} = 0, 1, \ldots, N_{\text{samp}}^{\text{group}} - 1\) are the intra-group indices of samples.</li>
<li>\(w(\cdot)\) is the <i>orthogonal cover code (OCC)</i> for port multiplexing purpose, which is essentially a Walse code of length \(N_{\text{samp}}^{\text{group}}\), implicitly indicated by \(n_{\text{RNTI}} \mod N_{\text{samp}}^{\text{group}}\).</li>
</ul>
</div>
</div>
<div id="outline-container-org024ee20" class="outline-3">
<h3 id="org024ee20">CP-OFDM</h3>
<div class="outline-text-3" id="text-org024ee20">
<p>
On each PTRS subcarrier, the QPSK symbol of the assocated DMRS port on the same subcarrier is reused and placed on the PTRS RE's.
</p>
</div>
</div>
</div>
<div id="outline-container-org310d0b0" class="outline-2">
<h2 id="sec:pn-estim-compl"><a id="org310d0b0"></a>Phase Noise Estimation and Complementation</h2>
<div class="outline-text-2" id="text-sec:pn-estim-compl">
<p>
Due to its non-selective nature in the frequency domain, phase noise is estimated in the frequency domain through the whole bandwidth scheduled, and then interpolation is performed in the time domain for the CP-OFDM or DFT-S-OFDM symbols without PTRS. The procedure is different for different waveforms. Hence, the procedure is presented in details for CP-OFDM based and DFT-S-OFDM based transmission, respectively.
</p>
</div>
<div id="outline-container-org955294a" class="outline-3">
<h3 id="cp-ofdm"><a id="org955294a"></a>CP-OFDM</h3>
<div class="outline-text-3" id="text-cp-ofdm">
<p>
For clear description, taking a PTRS port for instance, we suppose that a PTRS symbol \(x_{m, n}\) is transmitted over its associated DMRS port on a RE \((k_m, l_n)\), which corresponds to subcarrier \(k_m\) and OFDM symbol \(l_n\), i.e.,
</p>
\begin{align}
  y_{k_m, l_n} = H_{k_m, l_n} e^{j\theta_{l_n}} x_{m,n} + n_{k_m, l_n}, \quad m = 1, 2, \ldots, M; n = 1, 2, \ldots, N,
\end{align}
<p>
where \(y_{k_m, l_n}\), \(H_{k_m, l_n}\), and \(n_{k_m, l_n}\) are the received signal, channel fading, and the additive white Gaussian noise on RE \((k_m, l_n)\), respectively; \(\theta_{l_n}\) represents the phase noise on \(l_n\) th OFDM symbol.
</p>

<p>
Since phase noise fluctuates as time, the impairment of phase noise can be completely complemented by a phase difference relative to a reference. Without loss of generality, we identify the phase noise on the first PTRS symbol as the reference, and the phase noise on the symbol is zero, i.e. \(\theta_{l_1} = 0\). Then, the phase noise on PTRS symbol \(l_n\) can be estimated according to
</p>
\begin{align}
  \hat{\theta}_{l_n} = \arg \sum_{m=1}^M \dfrac{y_{k_m, l_n}x_{m, n}^*}{y_{k_m, l_1}x_{m, 1}^*}, \quad n = 2, 3, \ldots, N.
\end{align}
<p>
Then, if the time density of the PTRS is less than 1, i.e., \(L_\text{PTRS} > 1\), the phase noise of the OFDM symbols without PTRS can be obtained by interpolation.
</p>
</div>
</div>
<div id="outline-container-org944fbf0" class="outline-3">
<h3 id="dft-s-ofdm"><a id="org944fbf0"></a>DFT-S-OFDM</h3>
<div class="outline-text-3" id="text-dft-s-ofdm">
<p>
In DFT-S-OFDM case, which is different from CP-OFDM waveform, the PTRS samples are inserted into PUSCH samples before the DFT operation, i.e., in the time domain. Accordingly, the phase noise should also be estimated and complemented in the time domain, i.e., after the IDFT processing. Taking \(X\) PTRS groups/chunks with each comprised of \(K\) samples for instance, the received signal can be expressed as
</p>
\begin{align}
  r_{m, g, l_n} = h_{m, g, l_n} e^{j\theta_{m, g, l_n}} x_{m, g, l_n} + n_{m, g, l_n}, \quad m = 1, 2, \ldots, K; g = 1, 2, \ldots, X,
\end{align}
<p>
where the subscript tuple \((m, g, l_n)\) means \(m\) th sample position within \(g\) th PTRS group in DFT-S-OFDM symbol \(l_n\); accordingly, \(x_{m, g, l_n}\), \(\theta_{m, g, l_n}\), \(r_{m, g, l_n}\), \(h_{m, g, l_n}\), and \(n_{m, g, l_n}\) are the PTRS sample, the phase noise, the received signal (after IDFT), the effective channel fading and the effective additive white Gaussian noise at the sample position.
</p>

<p>
Then, the phase noises can be estimated by
\[
\theta_{m, g+1, l_n} - \theta_{m, g, l_n} = \arg \frac{\sum_{m=1}^K r_{m, g+1, l_n} x_{m, g+1, l_n}^{*}}{\sum_{m=1}^K r_{m, g, l_n} x_{m, g, l_n}^{*}}, \quad g = 1, \ldots, X - 1.
\]
</p>
</div>
</div>
</div>
<div id="outline-container-orgdbcd04e" class="outline-2">
<h2 id="sec:summary"><a id="orgdbcd04e"></a>Summary</h2>
<div class="outline-text-2" id="text-sec:summary">
<p>
This report summarized PTRS related knowledge, from principle to specification. However, the existing PTRS cannot satisfy the requirements of ongoing research topics, e.g., multi-panel and multi-TRP. Therefore, PTRS is bound to be extended and enhanced further in the near future.
</p>
</div>
</div>
</div>
</body>
</html>
